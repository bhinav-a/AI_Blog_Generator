{% extends 'scraper/base.html' %}

{% block title %}Scraped Data - {{ scraped_data.title }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Scraped Data Details</h2>
            <div>
                <a href="{% url 'scraper:index' %}" class="btn btn-secondary">Back to Home</a>
                {% if scraped_data.status == 'success' %}
                    <a href="{% url 'scraper:download' scraped_data.pk %}" class="btn btn-success">Download JSON</a>
                {% endif %}
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3 class="mb-0">{{ scraped_data.title|default:"No Title" }}</h3>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-md-3"><strong>URL:</strong></div>
                    <div class="col-md-9">
                        <a href="{{ scraped_data.url }}" target="_blank">{{ scraped_data.url }}</a>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3"><strong>Status:</strong></div>
                    <div class="col-md-9">
                        <span class="status-{{ scraped_data.status }}">
                            {{ scraped_data.get_status_display }}
                        </span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3"><strong>Scraped At:</strong></div>
                    <div class="col-md-9">{{ scraped_data.created_at|date:"F d, Y H:i:s" }}</div>
                </div>

                {% if scraped_data.error_message %}
                <div class="row mb-3">
                    <div class="col-md-3"><strong>Error:</strong></div>
                    <div class="col-md-9 text-danger">{{ scraped_data.error_message }}</div>
                </div>
                {% endif %}

                {% if json_content %}
                <div class="row">
                    <div class="col-12">
                        <h4>Scraped Data Preview</h4>
                        <div class="json-content">
                            <pre>{{ json_content|pprint }}</pre>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}