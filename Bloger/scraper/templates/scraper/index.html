{% extends 'scraper/base.html' %}
{% load static %}

{% block title %}Scraper_Interface // Home{% endblock %}

{% block content %}
<!-- Form section unchanged -->

{% if recent_scrapes %}
    <hr class="my-5" style="border-color: var(--border-glow);">
    
    <div class="text-center">
        <h3 class="display-6 fw-bold mb-4">> Recent Jobs</h3>
    </div>

    <div class="table-responsive">
        <table class="table table-dark table-hover align-middle table-borderless">
            <thead>
                <tr>
                    <th scope="col">TARGET_URL</th>
                    <th scope="col">PAGE_TITLE</th>
                    <th scope="col">STATUS</th>
                    <th scope="col">TIMESTAMP</th>
                    <th scope="col" class="text-end">ACTIONS</th>
                </tr>
            </thead>
            <tbody>
                {% for scrape in recent_scrapes %}
                <tr>
                    <td>
                        <a href="{{ scrape.url }}" target="_blank">{{ scrape.url|truncatechars:25 }}</a>
                    </td>
                    <td>{{ scrape.title|default:"// no title //"|truncatechars:30 }}</td>
                    <td>
                        <span class="status-badge status-{{ scrape.status|lower }}">
                            {{ scrape.status }}
                        </span>
                    </td>
                    <td>{{ scrape.created_at|date:"Y-m-d H:i:s" }}</td>
                    <td class="text-end">
                        {% if scrape.id and scrape.id != "" %}
                            <a href="{% url 'scraper:detail' scrape.id %}" class="btn btn-sm btn-outline-light">
                                <i class="bi bi-eye-fill me-1"></i>View
                            </a>
                            {% if scrape.status == 'success' %}
                                <a href="{% url 'scraper:download' scrape.id %}" class="btn btn-sm btn-outline-light ms-1">
                                    <i class="bi bi-download me-1"></i>Download
                                </a>
                            {% endif %}
                        {% else %}
                            <span class="text-muted">// no actions //</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endif %}
{% endblock %}